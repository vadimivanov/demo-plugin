angular.module("app",["ui.router","ncy-angular-breadcrumb","templates"]);
function config(e,t){"use strict";t.otherwise("home"),e.state("home",{url:"/home",template:"<home></home>"}).state("details",{url:"/details",template:"<details></details>"})}angular.module("app").config(config),config.$inject=["$stateProvider","$urlRouterProvider"];
function msg(){"use strict";function t(t,s){t.data={visible:!1,content:""},t.onMessage=function(s){t.data.visible=!0,t.data.content=s,console.log(t.data)},t.onClose=function(){t.data.visible=!1},PubSub.subscribe("messages",function(s,e){t.onMessage(e.status+": "+e.statusText)})}return{templateUrl:"components/modal.tpl.html",restrict:"E",scope:{},link:t}}angular.module("app").directive("msg",msg),msg.$inject=["messages"];
angular.module("app").service("messages",function(){var a={setData:function(t){a.data=t},getData:function(){return a.data}};return a.data=null,a});
function ParseService(e,r){Parse.initialize(r.APP_ID,r.JS_KEY),Parse.serverURL="https://parseapi.back4app.com",this.parseRequest=function(e,r){return new Promise(function(r,s){Parse.Cloud.run("xmlparser",{url:e},{success:function(e){var n=new X2JS,a=n.xml_str2json(e.text);r(a.rss.channel),s(a.rss.channel)},error:function(e){console.log("error",e)}})})}}angular.module("app").constant("CONFIG",{APP_ID:"a9jRLIufzpYFGbn44ZzF8Wl2gL3PbUAQIVz8vAx2",JS_KEY:"TT02USepmVKAtU3johi4sRUHDsnDT5GMJJyhXeNi"}).service("ParseService",ParseService),ParseService.$inject=["$http","CONFIG"];
function network(e,n){this.FEED_SRC="http://k.img.com.ua/rss/ru/news.xml",this.parseRSS=function(n){console.log("parseRSS",n,encodeURIComponent(n));var o={method:"GET",crossDomain:!0,url:n};return e(o)}}angular.module("app").service("network",network),network.$inject=["$http","CONFIG"];
function details(t,e,l,s){function a(t){t.details=s.getData(),t.getHtml=function(t){return e.trustAsHtml(t)},t.text=t.details.fulltext.__cdata,t.links=l.getStatesChain(),console.log("links ",t.links),PubSub.publish("button-back",t.links[t.links.length-2])}return{templateUrl:"details/details.tpl.html",restrict:"E",replace:!0,scope:{},link:a}}angular.module("app").directive("details",details),details.$inject=["$state","$sce","$breadcrumb","messages"];
function header(e,t){"use strict";function a(a){a.data={},console.log("$scope.data --> ",a.data),a.getLink=function(a){console.log(a),e.FEED_SRC=a,PubSub.publish("news",a),t.go("home")},a.goBack=function(){t.go(a.data.goBackLink),a.data={}},PubSub.subscribe("button-back",function(e,t){t&&(a.data.goBackTitle=t.title,a.data.goBackLink=t.link)})}return{templateUrl:"header/header.tpl.html",restrict:"E",replace:!0,scope:{},link:a}}angular.module("app").directive("header",header),header.$inject=["network","$state"];
function home(e,t,n,o,s){function i(i){i.feeds=[],i.spinner=!1,i.getHtml=function(e){return t.trustAsHtml(e)},i.loadButonText="Load",PubSub.subscribe("news",function(e,t){t&&i.loadFeed()}),i.tagParser=function(t){o.setData(i.feeds[t]),PubSub.publish("button-back",{link:"home",title:"Home"}),e.go("details")},i.loadFeed=function(e){i.spinner=!0,n.parseRequest(s.FEED_SRC).then(function(e){i.feeds=e.item,i.spinner=!1,i.$digest()})},i.render=function(e){i.feeds=e},i.loadFeed()}return{templateUrl:"home/home.tpl.html",restrict:"E",replace:!0,scope:{},link:i}}angular.module("app").directive("home",home),home.$inject=["$state","$sce","ParseService","messages","network"];